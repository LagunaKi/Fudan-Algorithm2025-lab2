Lab2复杂 DNA序列的比对

2025-04-28  
背景：常见 DNA变异

在 DNA序列分析中，各种变异非常常见。以下介绍常见的变异类型：  

单核苷酸突变

这是最常见的一类 DNA突变，主要表现形式为一个核苷酸发生了改变。例如：  

ref:    A T C G A  
query:  A A C G A  

序列第 2 位的 T 变为 A。  

插入突变

在 query 中出现了额外的核苷酸片段。例如：  

ref:    A T - - - - C G A 
query:  A T A C T T C G A  

插入片段 `ACTT`。  

删除突变

query 中缺失了核苷酸片段。例如：  

ref:    A T G G T A C G A  
query: A T - - - - C G A  

缺失片段 `GGTA`。  

重复突变

query 中出现了重复片段。例如：  

ref:    A T C G - - - A  
query: A T C G T C G A  

片段 `TCG` 重复 1 次。  

倒位（逆转）突变

query 中的序列是 ref 的反向互补序列。例如：  

ref:    5'-A T C G-3'  
query:  5'-C G A T-3'  

在这个例子中，ref 序列为 5’-ATCG-3’，其反向互补序列为 3’-TAGC-5’，或者写作
5’-CGAT-3’（一般情况下默认 5’ 写在左侧，3’ 写在右侧）。

片段移位

同时发生插入和删除突变。例如：  

ref:    A T G G T A C G A - - - T T C  

query: A T G - - - C G A G T A T T C  

片段 `GTA` 从位置 4-6 移动到 7-9。  

项目目标

实现复杂 DNA 序列的比对，兼顾算法时空复杂度和准确性。具体要求：  
对 PPT 提供的两组 query 和 reference 进行匹配。  
，实现 query 和reference 的匹配，并输出具体的匹配情况。其中，匹配过程中可能会遇到以上提及的变异类型，也可能出现其他类型的变异。

具体细节

3.1 输入与输出

输入：  
`query` 和 `reference` 序列（由 `ATCG` 构成的字符串）。  

输出：  
若干元组 `(query_start, query_end, ref_start, ref_end)`，表示匹配的片段。  表示 query 中从 query_start 到 query_end 的序列与 reference 中ref_start 到 ref_end 的序列匹配。若两者为反向互补匹配（即 query_start 与 ref_end配对），无需特别修改start 和end 的顺序，提交时会自动判断。

示例输出：  

  python
  [(0,399,0,399), (400,449,350,399), ..., (1010,1409,400,799)]
  

3.2 实现思路提示
变异模糊性：本次Lab中，由于采用的是较为真实的数据，变异的具体情况是比较模糊的，没有所谓“合法的变异”一说。也正因为如此，本次Lab不再要求计算出从ref到query所发生的具体变换方式，仅要求计算两者的匹配关系，即query中的某一片段与ref中的哪一片段相匹配。因此，请在编写代码时考虑更加通用的情况，避免用固定化的表达式来描述每一类变异

哈希优化：我们是否可以一次匹配多个碱基，从而大幅减小复杂度中的系数？hash在这里可能会很有用：可以通过设计特定的hash 函数使得两个相似的序列发生碰撞，从而认为这两个相似序列几乎是一致的，以减小微小变异（例如单核苷酸突变）对整体匹配的干扰 

动态规划优化：常规的动态规划方法要求填完整个打分矩阵，因此复杂度必然是Ω(mn)级别（其中m,n 分别为ref 和 query 的长度）。如果想要降低复杂度，一个思路是考虑在打分矩阵中有哪些位置是一定不用计算的，或者在已知某些位置的分数下有哪些位置可以不用计算 

图算法：  
本次Lab 需要使用图相关算法实现。图的结点表示ref和query中核苷酸的匹配情况，图的边表示上一个匹配到下一个匹配的转移过程，算法目标是找到图中的最长路径。提示关键词：“anchor”（匹配的片段作为锚点），“chain”（延伸并连接锚点）
 

相关要求

扩展性：只需处理 PPT 提供的两组序列。  

正确性：评分网站得分需不低于基线。  

复杂度：时间复杂度 ≤ O(mn)，线性复杂度可得满分。  

提交要求：  

Elearning：实验文档（伪代码、复杂度分析、结果）。  

GitHub：更新代码。  

评分网站实名提交：  

第一组输入：http://10.20.26.11:8550  

第二组输入：http://10.20.26.11:8551  

截止时间：2025.5.31 23:59